
open_basedir = /var/www/html:/tmp
allow_url_include = Off

; 2. Error Reporting
; Turn off display_errors for production/CTF. Errors go to logs.
display_errors = Off 
log_errors = On
error_log = /var/log/apache2/php_errors.log
error_reporting = E_ALL & ~E_NOTICE & ~E_STRICT & ~E_DEPRECATED

; 3. Security/Information Disclosure
expose_php = Off

; 4. Disable Dangerous RCE Functions (excluding the intended RCE payload function)
; 'system' and backticks (which call exec/shell_exec) must be available for the exploit.
disable_functions = pcntl_alarm,pcntl_fork,pcntl_waitpid,pcntl_wait,pcntl_wifexited,pcntl_wifstopped,pcntl_wifsignaled,pcntl_wifcontinuing,pcntl_wexitstatus,pcntl_wtermsig,pcntl_wstopsig,pcntl_signal,pcntl_signal_dispatch,pcntl_get_last_error,pcntl_strerror,pcntl_sigprocmask,pcntl_sigwaitinfo,pcntl_sigtimedwait,pcntl_exec,pcntl_getpriority,pcntl_setpriority,dl,proc_open,proc_close,proc_terminate,proc_get_status,proc_nice,ini_alter,ini_restore,highlight_file,show_source,symlink,link,stream_socket_server,pfsockopen,fsockopen,popen,apache_child_terminate,apache_setenv,define_syslog_variables,escapeshellarg,escapeshellcmd,eval,ini_set,mail,mb_send_mail,openlog,pclose,syslog,disk_free_space,disk_total_space,dl,posix_ctermid,posix_get_last_error,posix_getcwd,posix_getegid,posix_geteuid,posix_getgid,posix_getgrgid,posix_getgrnam,posix_getgroups,posix_getlogin,posix_getpgid,posix_getpgrp,posix_getpid,posix_getppid,posix_getpwnam,posix_getpwuid,posix_getrlimit,posix_getsid,posix_getuid,posix_isatty,posix_kill,posix_mkfifo,posix_setegid,posix_seteuid,posix_setgid,posix_setpgid,posix_setsid,posix_setuid,posix_times,posix_ttyname,posix_uname,assert
