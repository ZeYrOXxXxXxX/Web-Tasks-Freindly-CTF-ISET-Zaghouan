services:
  webapp:
    image: nginx:1.21-alpine
    container_name: challenge-meme-hunt
    restart: always
    ports:
      - "5009:80" # Using a new port
    volumes:
      # Mounts our 'public' folder to be served by Nginx
      - ./public:/usr/share/nginx/html
      # Mounts our custom Nginx configuration
      - ./nginx.conf:/etc/nginx/conf.d/default.conf
    # Security Constraints
    read_only: true
    
    # --- THE FIX ---
    # Nginx needs writable directories for its temporary files and logs.
    # We mount these as in-memory tmpfs volumes so the rest of the
    # filesystem can stay read-only.
    tmpfs:
      - /var/run
      - /var/cache/nginx
      - /tmp

    mem_limit: 128m
    pids_limit: 100
